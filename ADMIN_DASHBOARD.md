# 🔐 관리자 대시보드 사용 가이드

## 📊 개요

KOICA 사업 심사 시스템의 관리자 전용 대시보드입니다.
**일반 사용자에게는 노출되지 않으며**, 권한이 있는 관리자만 접근할 수 있습니다.

## 🔒 보안 정책

- 관리자 대시보드는 일반 사용자의 사이드바에 표시되지 않습니다
- 비밀번호 인증을 통해서만 접근 가능합니다
- 인증 실패 시도는 로그에 기록됩니다
- 개인정보는 수집하지 않으며, 익명 사용 통계만 표시합니다

## 🚀 실행 방법

### 1. 관리자 비밀번호 설정

먼저 비밀번호 해시를 생성합니다:

```bash
python generate_admin_password_hash.py
```

출력된 해시 값을 `.streamlit/secrets.toml` 파일에 추가:

```toml
# Gemini API 키
GEMINI_API_KEY = "your-api-key-here"

# 관리자 비밀번호 해시
ADMIN_PASSWORD_HASH = "생성된_해시_값"
```

### 2. 관리자 대시보드 실행

```bash
streamlit run admin/dashboard.py
```

### 3. 로그인

- 브라우저가 자동으로 열립니다
- 설정한 관리자 비밀번호를 입력하여 로그인합니다

## 📈 주요 기능

### 1. 전체 요약 통계
- 총 세션 수
- 총 분석 수 (PDF + 텍스트)
- 성공률
- 평균 파일 크기

### 2. 일별 사용 추이
- 세션 및 분석 수 차트
- 성공/실패 분석 차트
- 파일 크기 추이 차트
- 기간 선택 가능 (7~90일)

### 3. 최근 활동 로그
- 최근 활동 내역 (익명)
- 시간, 활동 유형, 성공/실패, 에러 타입
- CSV 내보내기 기능

## 🔐 수집되는 데이터 (익명)

다음 데이터만 수집됩니다:

✅ **수집하는 데이터:**
- 익명 세션 ID (무작위 UUID)
- 타임스탬프
- 사용한 기능 (PDF/텍스트 분석)
- 파일 크기 (바이트)
- 성공/실패 여부
- 에러 타입

❌ **수집하지 않는 데이터:**
- IP 주소
- 사용자 이름, 이메일
- 파일 이름, 파일 내용
- 분석 결과 내용

## 📁 데이터 위치

- **데이터베이스:** `analytics/usage_data.db` (SQLite)
- **로그 파일:** `logs/koica_auditor.log`

⚠️ 두 폴더 모두 `.gitignore`에 포함되어 Git에 커밋되지 않습니다.

## 🛡️ 보안 권장사항

1. **비밀번호 관리**
   - 강력한 비밀번호 사용 (최소 12자 이상, 영문/숫자/특수문자 조합)
   - 비밀번호를 다른 사람과 공유하지 마세요
   - 정기적으로 비밀번호 변경

2. **접근 제어**
   - 공용 컴퓨터에서 사용 후 반드시 로그아웃
   - secrets.toml 파일을 Git에 커밋하지 마세요
   - 관리자 권한이 필요한 사람에게만 비밀번호 공유

3. **로그 확인**
   - 정기적으로 로그인 실패 시도 확인
   - `logs/koica_auditor.log`에서 의심스러운 활동 모니터링

## 💡 문제 해결

### Q: 비밀번호를 잊어버렸어요
A: `generate_admin_password_hash.py`를 다시 실행하여 새로운 비밀번호 해시를 생성하고, `.streamlit/secrets.toml`을 업데이트하세요.

### Q: 데이터가 표시되지 않아요
A: 메인 앱(`koica_appraisal_app.py`)이 최소 한 번 이상 실행되어야 데이터가 수집됩니다.

### Q: 로그인이 안 돼요
A:
1. `.streamlit/secrets.toml`에 `ADMIN_PASSWORD_HASH`가 올바르게 설정되어 있는지 확인
2. 비밀번호 해시가 정확한지 확인
3. `logs/koica_auditor.log`에서 에러 확인

## 📞 문의

관리자 권한이 필요한 경우 시스템 관리자에게 문의하세요.
